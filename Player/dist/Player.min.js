!function(e){var t={};function n(l){if(t[l])return t[l].exports;var r=t[l]={i:l,l:!1,exports:{}};return e[l].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,l){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:l})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}({7:function(e,t,n){"use strict";var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var l=t[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(t,n,l){return n&&e(t.prototype,n),l&&e(t,l),t}}();var r={timemat:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t?Math.floor(e/3600):0,l=Math.floor((e-3600*n)/60),r=Math.floor(e-3600*n-60*l);return n=n<10?"0"+n:n,l=l<10?"0"+l:l,r=r<10?"0"+r:r,(t?n+":":"")+l+":"+r},addEvent:function(e,t,n){var l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];window.addEventListener?e.addEventListener(t,n,l):window.attachEvent&&e.attachEvent("on"+t,n)},addClass:function(e,t){if(e.classList)e.classList.add(t);else{var n=e.className.split(/\s+/);-1===this.indexOf(n,t)&&n.push(t),e.className=n.join(" ")}},indexOf:function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,l=e.length;n<l;n++)if(e[n]===t)return n;return-1},removeClass:function(e,t){if(e.classList)e.classList.remove(t);else{var n,l=e.className.split(/\s+/);-1!==(n=this.indexOf(l,t))&&l.splice(n,1),e.className=l.join(" ")}},isFullscreen:function(){return document.fullscreen||document.webkitIsFullScreen||document.mozFullScreen||!1},exitFullscreen:function(){document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},fullscreen:function(e){e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()},time:function(e){var t=e.split(/[:：]+/);return 3===t.length?3600*parseInt(t[0])+60*parseInt(t[1])+parseFloat(t[2]):60*parseInt(t[0])+parseFloat(t[1])},calced:function(e,t){return e&&1===e.nodeType&&window.getComputedStyle?window.getComputedStyle(e)[t]:0},setTransformY:function(e,t,n){"transform"in document.documentElement.style?e.style.webkitTransform=e.style.mozTransform=e.style.msTransform=e.style.oTransform=e.style.transform="translateY("+(n?t+"px":"-"+t+"00%")+")":e.style.top=n?t+"px":"-"+t+"00%"}},s=/player-lrc-mode-[0-9]+/g,i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=document.querySelector(t);n&&(this.lrcData=null,this.lrcKeys=null,this.lrcLen=0,this.showLrcLines=7,this.__define__("xhr",{value:new XMLHttpRequest}),this.__define__("timer",{writable:!0,value:0}),this.__dom__(),this.__obs__(),n.appendChild(this[0]),this.__events__(),this.volume=.5,this.__define__("private",{value:1}))}return l(e,[{key:"__dom__",value:function(){e.__check__(this.private,"__dom__"),this[0]=document.createElement("div"),this[0].className="player player-1",this[0].innerHTML='\n        <video data-name="video" class="player-video"></video>\n        <div data-name="lrc" class="player-lrc"></div>\n        <div data-name="ctrls" class="player-controls">\n            <div class="player-slider" title="播放时间滑块">\n                <div data-name="buf" class="player-slider-buf"></div>\n                <div data-name="thumb" class="player-slider-thumb"></div>\n            </div>\n            <div class="player-toolbar">\n                <div class="player-toolbar-left">\n                    <div data-name="btn" class="player-btn" title="播放/暂时"></div>\n                    <div data-name="cur" class="player-current-time">--:--</div>\n                    <div data-name="dur" class="player-duration">/ --:--</div>\n                </div>\n                <div class="player-toolbar-right">\n                    <div data-name="vbtn" class="player-vol-btn" title="音量">\n                        <i class="player-vol-rect"></i>\n                        <i class="player-vol-tri"></i>\n                        <i class="player-vol-stat">\n                            <i class="player-vol-dot1"></i>\n                            <i class="player-vol-dot2"></i>\n                            <i class="player-vol-dot3"></i>\n                            <i class="player-vol-mute">&times;</i>\n                        </i>\n                        <div class="player-vol-slidebar">\n                            <div class="player-vol-slide-track">\n                                <div data-name="vslider" class="player-vol-slider"></div>\n                            </div>\n                        </div>\n                    </div>\n                    <div data-name="rate" class="player-rate" title="播放速率">1x</div>\n                    <div data-name="fscreen" class="player-fullscreen" title="全屏切换">\n                        <i class="player-fullscreen-tl"></i>\n                        <i class="player-fullscreen-tr"></i>\n                        <i class="player-fullscreen-bl"></i>\n                        <i class="player-fullscreen-br"></i>\n                    </div>\n                </div>\n            </div>\n        </div>',this.els={loading:document.createElement("div")},this.els.loading.className="r-loading";for(var t=this[0].querySelectorAll("[data-name]"),n=t.length,l=0;l<n;l++)this.els[t[l].getAttribute("data-name")]=t[l],t[l].removeAttribute("data-name")}},{key:"__define__",value:function(t,n){e.__check__(this.private,"__define__"),Object.defineProperty(this,t,n)}},{key:"__ob__",value:function(t,n){e.__check__(this.private,"__ob__");var l=void 0;this.__define__(t,{set:function(e){e!==l&&(l=e,n(e))},get:function(){return l}})}},{key:"__obs__",value:function(){e.__check__(this.private,"__obs__");var t=this;t.__ob__("src",function(e){t.lrc="",t.lrcData=null,t.lrcKeys=null,t.lrcLen=0,t.poster="",t.els.video.src=e}),t.__ob__("poster",function(e){e?t.els.video.poster=e:t.els.video.removeAttribute("poster")}),t.__ob__("currentTime",function(e){t.els.cur.innerText=r.timemat(e),t.els.thumb.style.width=e/t.duration*100+"%",t.getLrcActive(e)}),t.__ob__("volume",function(e){t.els.video.volume=e,t.els.vslider.style.height=100*e+"%"}),t.__ob__("activeIndex",function(){t.renderLrc()})}},{key:"__events__",value:function(){e.__check__(this.private,"__events__");var t=this,n=t.els.video,l=t.els.btn,s=t.els.loading;r.addEvent(window,"resize",function(){t.setLrcMode()}),r.addEvent(n,"loadstart",function(){t[0].appendChild(s)}),r.addEvent(n,"durationchange",function(){t.duration=this.duration,t.currentTime=0,t.els.dur.innerText="/ "+r.timemat(this.duration),t.els.video.playbackRate=parseFloat(t.els.rate.innerText),t.loadLrc()}),r.addEvent(n,"loadeddata",function(){t[0].removeChild(s)}),r.addEvent(n,"error",function(){s.innerHTML="加载失败",r.addClass(s,"r-loadend"),r.removeClass(s,"r-loading")}),r.addEvent(l,"click",function(){n.paused?(n.play(),n.autoplay=!0,r.addClass(l,"player-btn-playing")):(n.pause(),n.autoplay=!1,r.removeClass(l,"player-btn-playing"))}),r.addEvent(n,"timeupdate",function(){try{t.els.buf.style.width=n.buffered.end(n.buffered.length-1)/this.duration*100+"%"}catch(e){}t.currentTime=this.currentTime}),r.addEvent(t.els.thumb.parentNode,"click",function(e){if(n.duration>0){var l=e.offsetX/this.offsetWidth;t.currentTime=l*n.duration,n.currentTime=Math.round(l*n.duration)}}),r.addEvent(t.els.vslider.parentNode,"click",function(e){var n=this.getBoundingClientRect();t.volume=(n.bottom-e.clientY)/n.height}),r.addEvent(t.els.vbtn,"click",function(e){t.els.vslider.parentNode.parentNode.contains(e.target)||((n.muted=!n.muted)?r.addClass(t[0],"player-muted"):r.removeClass(t[0],"player-muted"))},!0),r.addEvent(t.els.rate,"click",function(){var e=parseFloat(this.innerText);(e+=.25)>2&&(e=.25),t.els.video.playbackRate=e,this.innerText=e+"x"}),r.addEvent(t.els.fscreen,"click",function(){r.isFullscreen()?(r.exitFullscreen(),r.removeClass(t.els.fscreen,"player-fullscreen-on")):(r.fullscreen(t[0]),r.addClass(t.els.fscreen,"player-fullscreen-on"))}),r.addEvent(t[0],"mousemove",function(e){t.timer&&clearTimeout(t.timer),t.els.ctrls.contains(e.target)||(t.showMouse(),t.timer=setTimeout(function(){t.hideMouse()},2e3))}),r.addEvent(t[0],"mouseleave",function(){t.hideMouse()})}},{key:"showMouse",value:function(){clearTimeout(this.timer),this[0].style.cursor="default",r.addClass(this.els.ctrls,"player-controls-show")}},{key:"hideMouse",value:function(){clearTimeout(this.timer),this[0].style.cursor="none",r.removeClass(this.els.ctrls,"player-controls-show")}},{key:"loadLrc",value:function(){var e=this;e.els.lrc.innerHTML="",this.lrc&&(this.xhr.open("get",this.lrc,!0),e.xhr.onreadystatechange=function(){if(4===e.xhr.readyState){var t="[00:00.00]找不到歌词/字幕";200===e.xhr.status&&(t=e.xhr.responseText),e.readLrc(t),e.showLrc(),e.setLrcMode()}},e.xhr.send())}},{key:"readLrc",value:function(e){var t=this,n=void 0;e&&(n=e.split(/\n+/),t.lrcData={},n.forEach(function(e){e.replace(/\[([0-9:.\[\]]+)\]/gi,function(n,l){if(n=e.slice(e.lastIndexOf("]")+1).replace(/\s+/g,""))for(var s=l.split(/\]\s*\[/),i=s.length,a=0;a<i;a++){var c=r.time(s[a]);t.lrcData[c]?t.lrcData[c]+="<br>"+n:t.lrcData[c]=n}})}),e=null,n=null,t.lrcKeys=Object.keys(t.lrcData),t.lrcKeys.sort(function(e,t){return Number(e)-Number(t)}),t.lrcLen=t.lrcKeys.length,t.activeIndex=0)}},{key:"getLrcActive",value:function(e){for(var t=0;t<this.lrcLen;t++){if(parseFloat(this.lrcKeys[t])-e>=0){this.lrcKeys[t-1]&&(this.activeIndex=t-1);break}}}},{key:"showLrc",value:function(){r.addClass(this.els.lrc,"player-lrc-show")}},{key:"hideLrc",value:function(){r.removeClass(this.els.lrc,"player-lrc-show")}},{key:"renderLrc",value:function(){if(1===this.lrcMode){this.els.lrc.innerHTML="";for(var e=this.showLrcLines,t=Math.floor(e/2),n=Math.round(100/(t+1)),l=0,r=0,s=n;l<e;l++)(r=this.activeIndex+l-t)<=this.activeIndex?s+=n:s-=n,this.lrcKeys[r]&&(this.els.lrc.innerHTML+='<div class="player-lrc-line'+(r===this.activeIndex?" player-lrc-line-active":"")+'" style="opacity: '+(s-n)/100+';">'+this.lrcData[this.lrcKeys[r]]+"</div>")}else this.els.lrc.innerHTML='<div class="player-lrc-line player-lrc-line-active">'+this.lrcData[this.lrcKeys[this.activeIndex]]+"</div>"}},{key:"setLrcMode",value:function(e){"number"==typeof e&&(this.lrcMode=e),this.lrcKeys&&this.renderLrc(),s.test(this.els.lrc.className)?this.els.lrc.className=this.els.lrc.className.replace(s,"player-lrc-mode-"+(this.lrcMode||0)):this.els.lrc.className+=" player-lrc-mode-"+(this.lrcMode||0);var t=this.els.lrc.children[0],n=32,l=void 0;t&&(n=t.offsetHeight+(Number(r.calced(t,"lineHeight"))||0)),l=1===this.lrcMode?(this[0].offsetHeight-n*this.showLrcLines)/2:this[0].offsetHeight-2*n,r.setTransformY(this.els.lrc,l,!0)}},{key:"setLrcLines",value:function(e){"number"==typeof e&&(this.showLrcLines=e,1===this.lrcMode&&this.setLrcMode())}}],[{key:"__check__",value:function(e,t){if(1===e)throw TypeError(t+"是私有方法，不可调用")}},{key:"toString",value:function(){return"{ [ class Player ] }"}}]),e}();window.Player=i}});